<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Cosmic Invader</title>
<style>
    body { margin: 0; background: black; color: white; overflow: hidden; }
    canvas { background: #000; display: block; margin: auto; }
</style>
</head>
<body>
<canvas id="game" width="600" height="400"></canvas>
<script>
const canvas = document.getElementById('game');
const ctx = canvas.getContext('2d');
const width = canvas.width;
const height = canvas.height;

// Player
const player = {
    x: width / 2,
    y: height - 30,
    size: 20,
    color: 'cyan',
    speed: 5,
    weapon: 'laser' // or 'bomb'
};

// Bullet and bomb arrays
const bullets = [];
const bombs = [];

// Enemy types with five colors
const enemyTypes = [
    { color: 'red', size: 20, score: 10 },
    { color: 'lime', size: 20, score: 15 },
    { color: 'orange', size: 20, score: 20 }
];

// Create enemies in rows
const enemies = [];
for (let i = 0; i < 5; i++) {
    for (let j = 0; j < enemyTypes.length; j++) {
        enemies.push({
            x: 60 + j * 50 + i * 90,
            y: 50 + j * 40,
            type: enemyTypes[j],
            dx: 1
        });
    }
}

let keys = {};

function drawPlayer() {
    ctx.fillStyle = player.color;
    ctx.beginPath();
    ctx.moveTo(player.x, player.y);
    ctx.lineTo(player.x - player.size / 2, player.y + player.size);
    ctx.lineTo(player.x + player.size / 2, player.y + player.size);
    ctx.closePath();
    ctx.fill();
}

function drawEnemies() {
    enemies.forEach(e => {
        ctx.fillStyle = e.type.color;
        ctx.fillRect(e.x - e.type.size/2, e.y - e.type.size/2, e.type.size, e.type.size);
    });
}

function drawBullets() {
    ctx.fillStyle = 'white';
    bullets.forEach(b => {
        ctx.fillRect(b.x - 2, b.y - 10, 4, 10);
    });
}

function drawBombs() {
    ctx.fillStyle = 'yellow';
    bombs.forEach(b => {
        ctx.beginPath();
        ctx.arc(b.x, b.y, 5, 0, Math.PI * 2);
        ctx.fill();
    });
}

function updateBullets() {
    for (let i = bullets.length - 1; i >= 0; i--) {
        bullets[i].y -= 8;
        if (bullets[i].y < 0) bullets.splice(i, 1);
    }
}

function updateBombs() {
    for (let i = bombs.length - 1; i >= 0; i--) {
        bombs[i].y -= 4;
        if (bombs[i].y < 0) bombs.splice(i, 1);
    }
}

function updateEnemies() {
    for (let i = enemies.length - 1; i >= 0; i--) {
        let e = enemies[i];
        e.x += e.dx;
        if (e.x < 20 || e.x > width - 20) e.dx *= -1;
    }
}

function handleCollisions() {
    for (let i = enemies.length - 1; i >= 0; i--) {
        let e = enemies[i];
        for (let j = bullets.length - 1; j >= 0; j--) {
            if (Math.abs(bullets[j].x - e.x) < 10 && Math.abs(bullets[j].y - e.y) < 10) {
                enemies.splice(i, 1);
                bullets.splice(j, 1);
                break;
            }
        }
        for (let j = bombs.length - 1; j >= 0; j--) {
            if (Math.abs(bombs[j].x - e.x) < 15 && Math.abs(bombs[j].y - e.y) < 15) {
                enemies.splice(i, 1);
                bombs.splice(j, 1);
                break;
            }
        }
    }
}

function updatePlayer() {
    if (keys['ArrowLeft'] && player.x > 10) player.x -= player.speed;
    if (keys['ArrowRight'] && player.x < width - 10) player.x += player.speed;
}

function loop() {
    ctx.clearRect(0, 0, width, height);
    updatePlayer();
    updateBullets();
    updateBombs();
    updateEnemies();
    handleCollisions();
    drawPlayer();
    drawEnemies();
    drawBullets();
    drawBombs();
    requestAnimationFrame(loop);
}

window.addEventListener('keydown', e => {
    keys[e.key] = true;
    if (e.key === ' ') {
        if (player.weapon === 'laser') {
            bullets.push({ x: player.x, y: player.y });
        } else {
            bombs.push({ x: player.x, y: player.y });
        }
    } else if (e.key === 'w') {
        player.weapon = player.weapon === 'laser' ? 'bomb' : 'laser';
    }
});
window.addEventListener('keyup', e => { keys[e.key] = false; });

loop();
</script>
</body>
</html>
